# アイデアマーケット｜画面設計書（UI仕様）v1.0

**対象：** ホームページ刷新（Wix→AWS）  
**目的：** 要件定義・基本設計を受け、P0（MVP）で必要な画面UI仕様を確定する  
**範囲：** PDF仕様の①〜⑧画面（表紙／登録／当初＋コメント／最終／検索／規約・技術・会社情報／広告／管理）

---

## 📋 目次

- [0. ドキュメント情報](#0-ドキュメント情報)
- [1. 画面一覧](#1-画面一覧)
- [2. 共通ナビゲーション・レイアウト](#2-共通ナビゲーション・レイアウト)
- [3. 画面詳細（UI仕様）](#3-画面詳細ui仕様)
- [4. ダイアログ／トースト／バリデーション文言](#4-ダイアログトーストバリデーション文言)
- [5. レスポンシブ・アクセシビリティ](#5-レスポンシブ・アクセシビリティ)
- [6. 画面遷移（サマリ）](#6-画面遷移サマリ)
- [7. 受入基準（画面別）](#7-受入基準画面別)
- [8. 計測イベント仕様（抜粋）](#8-計測イベント仕様抜粋)
- [9. 付録：フィールド設計（抜粋）](#9-付録フィールド設計抜粋)

---

## 0. ドキュメント情報

### 📄 基本情報
- **版：** v1.0（初版）
- **想定技術：** Next.js（App Router）、Tailwind、Headless UI、SSG/SSR 併用

### 🎨 デザイン仕様
- **共通マージン：** モバイル 16px／タブレット 24px／デスクトップ 32px
- **ブレークポイント：** sm=640, md=768, lg=1024, xl=1280
- **共通フォントサイズ：** 本文 16px（1.0rem）、見出し h1=32, h2=24, h3=20
- **カラー（仮）：** Brand #1E3A8A / Accent #2563EB / Text #111827 / Sub #6B7280
- **アイコン：** Lucide（20/24px）

### 📊 計測対象
view / click / submit / search / purchase / ad_impression / ad_click

---

## 1. 画面一覧

| ID | 画面名 | URL | 主なロール | 目的 |
|---|---|---|---|---|
| **GM-01** | 表紙（ホーム） | `/` | 全員 | 主要導線へのランディング（登録／当初／最終／検索／規約／広告） |
| **GM-02** | 登録 | `/signup` | 会員（A/B/K） | 会員登録・規約同意の取得 |
| **GM-03** | 当初入力＋コメント | `/ideas/new` <br> `/ideas/{id}` | A/B | 当初アイデア投稿、スレッド形式のコメント蓄積 |
| **GM-04** | 最終入力（X/Y作成） | `/ideas/final/new` | A | 概要版X（公開）と詳細版Y（有償）の作成 |
| **GM-05** | 検索 | `/search` | 全員/K | CMT番号／キーワード検索（当初＋コメント／最終X/Y） |
| **GM-06** | 規約・技術・会社情報 | `/legal` | 全員/管理者 | 規約・技術情報・会社情報の公開＆管理者追記 |
| **GM-07** | 広告 | `/ads` | 全員/管理者 | 広告バナーの一覧・ポリシー・（将来）広告主向け説明 |
| **GM-08** | 管理 | `/admin` | 管理者 | 各画面ジャンプ、編集、ログDL（CSV/TXT） |

---

## 2. 共通ナビゲーション・レイアウト

### 🔝 ヘッダー
- **左：** ロゴ
- **右：** ナビ（表紙/当初/最終/検索/規約/広告/登録 or マイページ）
- **モバイル：** ハンバーガー

### 🔽 フッター
- 会社情報ショートカット
- 著作権表示
- SNS
- 問い合わせ

### 🍞 トースト
- **成功：** 緑
- **警告：** 黄
- **失敗：** 赤

### 📝 フォーム要件
- 必須*
- 最大長
- プレースホルダ
- 補助テキスト
- エラーメッセージ

### ♿ アクセシビリティ
- ラベルfor
- aria-*
- Tab順
- フォーカス可視化
- コントラスト≥4.5:1

---

## 3. 画面詳細（UI仕様）

### 🏠 GM-01 表紙（ホーム）

#### レイアウト
- **Hero：** キービジュアル、キャッチコピー、主要CTA（登録／当初投稿／検索）
- **セクション：** サービス説明（①投稿→②コメント→③X/Y→④検索→⑤広告→⑥購入）、最新Xカード、バナー広告枠（Top/中腹/フッター直上）

#### 主要コンポーネント
- CTAボタン群
- 最新Xカード（タイトル/サマリ/タグ/作成日/購入数）
- 広告枠（標準 300×250, 728×90 レスポンシブ）

#### アクション
- CTAクリック（`/signup`, `/ideas/new`, `/search`）

#### 空状態
- 最新Xなし→"最終アイデア（X）を作成するとここに表示されます"

#### 📊 計測
- `home_view`
- `cta_click:{target}`
- `ad_impression`
- `ad_click`

#### 🔍 SEO
- **タイトル：** アイデアマーケット｜アイデアの投稿・検索・購入
- OGP
- 構造化（Breadcrumb）

---

### 📝 GM-02 登録（/signup）

#### フォーム項目
| 項目 | 必須 | 制約 | 備考 |
|---|---|---|---|
| メール | ✅ | email形式, 最大254 | |
| パスワード | ✅ | 12〜128, 英大小/数/記号1種以上 | |
| 役割 | ✅ | member/company | 初期は member、企業は別導線（将来） |
| 規約同意 | ✅ | チェック・リンク表示 | |

#### バリデーション
- 入力即時検証＋送信時二重検証

#### メッセージ
- **成功：** 確認メール送信トースト→メール検証画面案内
- **失敗：** 重複メール／弱いパスワード／同意未チェック

#### 📊 計測
- `signup_submit:{result}`
- `terms_view`

#### 🔄 遷移
- 成功→`/` or 直前参照画面

---

### 💡 GM-03 当初入力＋コメント（/ideas/new, /ideas/{id}）

#### 🎯 目的
当初アイデア投稿＆スレッド型議論（LINE風）

#### 🏗️ 構成
- **左ペイン：** 当初アイデア概要（タイトル/概要/タグ/添付）、メタ（作成者/作成日/CMT-YYMMDD-####）
- **右ペイン：** コメントタイムライン（吹き出し、時刻、送信者）
- **フッター：** コメント入力欄（テキスト、画像添付）、送信ボタン

#### 📋 当初アイデア入力項目
| 項目 | 必須 | 制約 | 備考 |
|---|---|---|---|
| タイトル | ✅ | 1〜100文字 | |
| 概要 | ✅ | 20〜2000文字 | |
| タグ | | 0〜5個、各1〜20文字 | |
| 添付 | | pdf/png/jpg/webp ≤ 20MB | |

#### 💬 コメント仕様
- **テキスト：** 1〜1000文字、行末改行は保持
- **添付：** 任意

#### ⚙️ 機能
- cmt_no自動採番
- 編集（一定時間内）
- 通報
- スクロール保持
- 仮想化リスト

#### 🔗 空状態
- **コメント0件：** "最初のコメントを投稿しましょう"

#### 📊 計測
- `idea_create`
- `comment_post`
- `attachment_upload`

#### 🔄 遷移
- **保存後：** `/ideas/{id}`（詳細）

---

### 🏆 GM-04 最終入力（X/Y作成）（/ideas/final/new）

#### 🎯 目的
概要版X（公開）／詳細版Y（有償）の作成

#### 🏗️ 構成
- Xタブ
- Yタブ
- プレビュー
- 公開ボタン

#### 📄 X版項目
| 項目 | 必須 | 制約 | 備考 |
|---|---|---|---|
| タイトル | ✅ | | |
| サマリ | ✅ | 50〜2000文字 | |
| 関連タグ | | | |
| 関連する当初スレッド選択 | | | |

#### 💰 Y版項目
| 項目 | 必須 | 制約 | 備考 |
|---|---|---|---|
| 本文 | ✅ | 200〜10000文字 | |
| 添付 | | private | |
| 価格 | ✅ | 0〜999,999円, 税込表示 | |
| 利用許諾チェック | ✅ | | |

#### 🔐 公開制御
- **X：** 公開
- **Y：** 非公開（購入者のみ）

#### 📊 計測
- `final_create_x`
- `final_create_y`
- `final_publish`

#### 💬 メッセージ
- 公開成功
- 必須未入力
- 価格不正
- 許諾未同意

---

### 🔍 GM-05 検索（/search）

#### 🔎 検索バー
- CMT番号入力欄（明示ヒント）
- キーワード入力欄
- 検索ボタン

#### 🎛️ フィルタ
- **対象：** 当初+コメント／最終X／最終Y[ロック表示]
- **並び順：** 関連/新着/人気

#### 📋 結果リスト
- **当初+コメント：** スレッドカード（CMT番号／タイトル／抜粋／最新コメント時刻）
- **最終成果（X/Y）：** カード（タイトル／サマリ／タグ／購入数／Yはロックアイコン）

#### 📢 行内広告
- 順位 1位/5位/末尾にレスポンシブ広告枠

#### 🔗 0件時
- 検索ヒント（例：同義語、タグ、期間なし検索）

#### 🔄 詳細遷移
- **スレッド：** `/ideas/{id}`
- **X：** `/ideas/{id}?tab=x`
- **Y：** 購入導線（`/purchase/{versionId}`）

#### 📊 計測
- `search_performed:{query, type}`
- `result_click`
- `ad_impression`
- `ad_click`

---

### 📄 GM-06 規約・技術・会社情報（/legal）

#### 🎯 目的
規約／プライバシー／特商法／技術情報／会社情報の掲出（CMS化）

#### 🏗️ 構成
- **左：** 目次（サイドナビ）
- **右：** 本文（WYSIWYG出力）

#### ⚙️ 管理
管理者はブロック単位で追記・更新・下書き保存・公開切替

#### 📊 計測
- `legal_view:{section}`

---

### 📢 GM-07 広告（/ads）

#### 🎯 目的
広告バナーの一覧表示、（将来）広告ポリシー／掲載方法

#### 🏗️ 構成
バナーカード（画像、リンク、掲載期間、ターゲットキーワード表示）

#### 🔗 検索画面との関連
検索クエリに応じて広告をマッチし、検索結果内の3枠にレンダリング

#### 📊 計測
- `ad_gallery_view`
- `ad_click`

---

### ⚙️ GM-08 管理（/admin）

#### 🎯 目的
各画面へのジャンプ、コンテンツ編集、ログ出力（CSV/TXT）

#### 🏗️ 構成
- **クイックランチャー：** 表紙／登録／当初／最終／検索／規約／広告
- **ログDL：** 期間／イベント種別（create/update/delete/login/purchase/ad_*）
- **CMS：** 規約/技術/会社情報の編集UI

#### 🔒 セキュリティ
管理者のみ、2FA、IP制限（運用で制御）

#### 📊 計測
- `admin_view`
- `log_export`

---

## 4. ダイアログ／トースト／バリデーション文言

### ❌ エラーメッセージ
- **共通エラー：** 通信に失敗しました。しばらくしてから再度お試しください。
- **必須エラー：** 必須項目です。
- **形式エラー：** 入力形式が正しくありません。
- **長さエラー：** {min}〜{max}文字で入力してください。
- **アップロード：** 20MB以下のpdf/png/jpg/webpに対応しています。

### ✅ 成功メッセージ
- **購入成功：** 購入が完了しました。詳細版の閲覧が可能です。

---

## 5. レスポンシブ・アクセシビリティ

### 📱 レスポンシブデザイン
- コンポーネントはモバイルファーストで実装

### 🖥️ 表示密度
- **モバイル：** 単一カラム
- **タブレット：** 2カラム
- **デスクトップ：** 2〜3カラム

### ♿ アクセシビリティ
- **キーボード操作：** 主要導線はすべて完了可能

---

## 6. 画面遷移（サマリ）

### 🔄 メインフロー
```
/ → /signup / /ideas/new / /ideas/{id} / /ideas/final/new / /search / /legal / /ads / /admin
```

### 🔍 検索結果からの遷移
- **当初アイデア：** `/ideas/{id}`
- **X版：** `/ideas/{id}?tab=x`
- **Y版購入：** `/purchase/{versionId}` → 成功 → `/my/purchases`

---

## 7. 受入基準（画面別）

- **GM-03：** 保存時に CMT-YYMMDD-#### が採番され、当該スレッド詳細へ遷移する
- **GM-05：** CMT番号完全一致でスレッド単体が表示され、キーワード検索で X 一覧が表示される
- **GM-04：** X は公開状態で誰でも閲覧可能、Y は購入完了後のみ閲覧可能
- **GM-08：** 管理者が期間指定でログCSV/TXTをダウンロードできる

---

## 8. 計測イベント仕様（抜粋）

| event_name | 送出画面 | 必須prop |
|------------|----------|----------|
| `home_view` | `/` | referrer |
| `signup_submit` | `/signup` | result(success/fail) |
| `idea_create` | `/ideas/new` | idea_id |
| `comment_post` | `/ideas/{id}` | idea_id, length |
| `final_publish` | `/ideas/final/new` | version_id, type(X/Y) |
| `search_performed` | `/search` | query, type(initial/thread/x/y) |
| `result_click` | `/search` | target_id, type |
| `ad_impression` | `/`, `/search` | ad_id |
| `ad_click` | `/`, `/search`, `/ads` | ad_id |
| `log_export` | `/admin` | range_from, range_to, kind |

---

## 9. 付録：フィールド設計（抜粋）

| 画面 | フィールド | 型/制約 | プレースホルダ | 必須 |
|------|------------|----------|------------------|------|
| 登録 | email | email, ≤254 | your@email.com | ✅ |
| 登録 | password | 12–128, 英大小/数/記号 | ******** | ✅ |
| 当初 | title | 1–100 | 例：○○の新規事業案 | ✅ |
| 当初 | summary | 20–2000 | 例：課題/解決/差別化の要点 | ✅ |
| 当初 | tags[] | 0–5, 各1–20 | 例：医療, SaaS | |
| 最終X | title | 1–100 | 例：○○の市場参入プラン | ✅ |
| 最終X | summary | 50–2000 | 例：要点・効果・前提など | ✅ |
| 最終Y | body | 200–10000 | 本文… | ✅ |
| 最終Y | price | 0–999999 | 例：9800 | ✅ |

---

## 📝 備考

本設計は P0 を対象。P1 以降で広告入稿UI、返金部分、請求書払い、SSO等を追加予定。